# 05. データ設計書

## 1. 永続化データ
本システムでは、ユーザー設定および定義データを `chrome.storage.local` に保存する。
設定画面の実装は本フェーズでは行わないが、将来的な拡張性を考慮し、以下の構造でデータを保持する。

### 1.1. 設定オブジェクト (`settings`)

| キー | 型 | 初期値 | 説明 |
| :--- | :--- | :--- | :--- |
| `enableGestures` | boolean | `true` | マウスジェスチャ機能の有効/無効 |
| `enableDrag` | boolean | `true` | スーパードラッグ機能の有効/無効 |
| `trailColor` | string | `"#FF4081"` | ジェスチャトレイルの色 (HEX) |
| `trailWidth` | number | `4` | ジェスチャトレイルの太さ (px) |
| `minGestureDistance` | number | `10` | ジェスチャ方向判定の最小移動距離 (px) |
| `searchEngineUrl` | string | `"https://www.google.com/search?q=%s"` | スーパードラッグ検索用URLテンプレート |

### 1.2. ジェスチャ定義 (`gestures`)
ジェスチャパス文字列をキーとし、アクションIDを値とするマップ。

```json
{
  "U": "scroll_up",
  "D": "scroll_down",
  "L": "history_back",
  "R": "history_forward",
  "UL": "tab_prev",
  "UR": "tab_next",
  "DL": "close_tab_select_left",
  "DR": "close_tab_select_right",
  "LU": "zoom_in",
  "LD": "zoom_out",
  "RU": "new_tab",
  "RD": "fullscreen",
  "DU": "scroll_top",
  "UD": "scroll_bottom",
  "LR": "reload",
  "RL": "restore_tab"
}
```

## 2. データアクセス方針
*   拡張機能起動時（Service Worker起動時）およびContent Script注入時にストレージから設定を読み込む。
*   `chrome.storage.onChanged` イベントを監視し、設定変更時には動的に反映する（将来的な設定画面実装への備え）。
