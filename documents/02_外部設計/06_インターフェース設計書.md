# 06. インターフェース設計書

## 1. メッセージング・インターフェース
Content Script と Service Worker 間の通信仕様を定義する。
Chrome Extension の Message Passing (`chrome.runtime.sendMessage`, `chrome.runtime.onMessage`) を使用する。

### 1.1. リクエスト形式 (Content Script -> Service Worker)
すべてのメッセージは以下の JSON オブジェクト形式とする。

```typescript
interface ExtensionMessage {
  type: ActionType; // アクション種別
  payload?: any;    // 必要なパラメータ
}
```

### 1.2. レスポンス形式 (Service Worker -> Content Script)
非同期処理の結果を返す場合の形式。

```typescript
interface ExtensionResponse {
  success: boolean;
  data?: any;
  error?: string;
}
```

### 1.3. アクション定義 (`ActionType`)

| ActionType | Payload | 説明 |
| :--- | :--- | :--- |
| `OPEN_NEW_TAB` | `{ url: string, active: boolean }` | 新しいタブを開く |
| `SEARCH_TEXT` | `{ text: string }` | 指定テキストで検索を行う（新しいタブ） |
| `TAB_PREV` | `null` | 前のタブを選択 |
| `TAB_NEXT` | `null` | 次のタブを選択 |
| `CLOSE_TAB` | `{ selectLeft: boolean }` | 現在のタブを閉じ、隣接タブを選択 |
| `RESTORE_TAB` | `null` | 閉じたタブを開き直す |
| `ZOOM_IN` | `null` | 現在のタブを拡大 |
| `ZOOM_OUT` | `null` | 現在のタブを縮小 |
| `GET_SETTINGS` | `null` | 現在の設定を取得する |

※ Content Script内で完結するアクション（スクロール、履歴操作等）についてはメッセージングを行わない。
