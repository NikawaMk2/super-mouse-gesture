# 08. 非機能要件設計書

## 1. パフォーマンス
*   **描画負荷の低減**:
    *   ジェスチャトレイルの描画には `requestAnimationFrame` を使用し、ブラウザのリフレッシュレートに同期させる。
    *   Canvas は全画面サイズとするが、再描画領域を最適化し、CPU/GPUリソースの消費を抑える。
*   **イベント処理**:
    *   `mousemove` イベントは高頻度で発火するため、処理を軽量に保つ。
    *   複雑な計算は間引き（スロットリング）せずとも動作するようロジックを簡素化するが、必要であれば導入する。

## 2. 互換性
*   **ブラウザ**: Google Chrome (Latest Stable)
*   **OS**: Windows, macOS, Linux (Chromeが動作する環境)
*   **サイト互換性**:
    *   SPA (Single Page Application) や iframe を多用するサイトでも動作することを目指す。
    *   ただし、セキュリティ制限により `chrome://` や `edge://` などの特権ページ、およびChromeウェブストアのページでは動作しない（Chrome Extensionの仕様）。

## 3. セキュリティ
*   **Content Security Policy (CSP)**: MV3のデフォルトCSPに従う。
*   **入力値検証**: メッセージングで受け取るパラメータはService Worker側で検証する。

## 4. ユーザビリティ
*   **誤操作防止**:
    *   ドラッグ/ジェスチャの最小移動距離閾値を設け、クリック操作との区別を明確にする。
    *   右クリックメニュー（コンテキストメニュー）は、ジェスチャ成立時は抑制し、単なる右クリック時は通常通り表示させる（またはジェスチャモード中は完全に抑制し、ダブル右クリックなどで表示等の回避策を用意するか、本バージョンでは「ジェスチャ中は抑制」という単純な仕様とする）。
